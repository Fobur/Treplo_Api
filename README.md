# Описание сервисного Апи - v1

## Поисковой сервис

### Цель
Поисковой сервис должен производить поиск в доступных ресурсах (в дальнейшем это так же может быть файловое хранилище). Т.к. снаружи сервиса пока нельзя узнать о доступных ресурсов фильтрация по ним в рамках запроса пока не предполагается. Так же, в рамках первой версии, не будет фильтрации по свойствам трека (например по кодеку и контейнеру), так как принимающая сторона пока в состоянии обработать любой известный кодек

### Методы
- Search(string query, uint? limit = null) -> stream(TrackSearchResult);  
Метод принимает одну строку - поисковой запрос, и максимальное количестов элементов (опционально).  
Сервис должен предоставить не больше максимального количества элементов (без ограничений если лимит не указан) на любой запрос.  
Так же ответственностью сервиса является разбор url и предоставление результата из него, если в query оно указано 

## Сервис проигрывателей

### Цель
Сервис проигрывателей предоставляет две функции - хранение и манипуляции с состоянием проигрывателя (добавление/снятие трека с очереди, просмотр очереди, перемешивание и тд), а так же предоставление аудио потока, для запрошенного источника (пока только url, в дальнейшем может быть файловое хранилище). Преобразование аудио в нужный формат является собственностью потребителя

### Методы
- Play(AudioSource) -> stream(AudioFrame);  
Метод принимает описание источника и возвращает непосредственно аудио, разбитое на фреймы
- Enqueue(string playerId, Track track);  
Метод принимает id сессии проигрывателя и Track, который нужно добавить в очередь. Ничего не возвращает
- Dequeue(string playerId) -> Track?;  
Метод принимает id сессии и пытается снять Track с очереди. Если снять удалось, то этот Track возвращается, в противном случае ничего не возвращается
- GetState(string playerId) -> PlayerState;  
Методы принимает id сессии и возвращает текущее состояние проигрывателя
- Loop(string playerId) -> LoopState;  
Метод принимает id сессии и меняет в ней состояние зацикливания (есть/нет). Возвращает состояние после изменения
- Shuffle(string playerId) -> Track[];  
Метод принимает id сессии и выполняет перемешивание очереди. Возвращает результирующую очередь


## Модели 
- AudioSource - содержит информацию об источнике аудио (пока только url), а также о формате аудио и размере источника 
- AudioFrame - содержит массив аудио данных и информацию о том, последний ли это фрейм
- Track - содержит информацию о треке, такую как название, автора, продолжительность, информацию об источнике, изображение (если есть).
- TrackSearchResult - содержит Track и название ресурса, с которого он был получен
- LoopState - состояние зацикливания (On/Off)
- PlayerState - содержит очередь и LoopState  